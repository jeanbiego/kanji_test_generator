<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¼¢å­—ãƒ†ã‚¹ãƒˆ - {{ title }}</title>
    <style>
        /* å°åˆ·ç”¨CSS - ãƒ–ãƒ©ã‚¦ã‚¶ã®å°åˆ·æ©Ÿèƒ½ã«æœ€é©åŒ– */
        
        /* åŸºæœ¬è¨­å®š */
        @media print {
          * {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
          
          body {
            margin: 0;
            padding: 0;
            font-family: "Hiragino Sans", "Yu Gothic", "Meiryo", sans-serif;
            font-size: 16pt;
            line-height: 1.3;
            color: #000;
            background: #fff;
          }
          
          @page {
            size: A4 landscape;
            margin: 10mm;
          }
          
          /* 1ãƒšãƒ¼ã‚¸=1ã‚·ãƒ¼ãƒˆ */
          .sheet {
            width: 277mm;   /* A4æ¨ªå¹… - ä½™ç™½Ã—2 */
            height: 190mm;  /* A4ç¸¦å¹… - ä½™ç™½Ã—2 */
            padding: 10mm;  /* å†…å´ä½™ç™½ */
            box-sizing: border-box;
            page-break-after: always;
            page-break-inside: avoid;
            overflow: hidden;
            position: relative;
          }
          
          .sheet:last-child {
            page-break-after: avoid;
          }
          
          .sheet-content {
            width: 100%;
            height: 100%;
            writing-mode: vertical-rl;
            text-orientation: mixed;
          }
          
          /* ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆå‰Šé™¤ï¼‰ */
          header {
            display: none;
          }
          
          /* å•é¡Œã‚¨ãƒªã‚¢ */
          main {
            margin-bottom: 0;
            break-inside: avoid;
            page-break-inside: avoid;
          }
          
          .question-item {
            margin-right: 2mm;
            page-break-inside: avoid;
            break-inside: avoid;
            display: flex;
            align-items: flex-start;
          }
          
          .question-item:last-child {
            margin-right: 0;
          }
          
          .question-number {
            font-weight: bold;
            margin-right: 3mm;
            min-width: 6mm;
            font-size: 16pt;
          }
          
          .question-content {
            flex: 1;
          }
          
          .question-text {
            font-size: 14pt;
            line-height: 1.3;
            margin-bottom: 3mm;
          }
          
          .answer-space {
            display: flex;
            align-items: flex-start;
            gap: 3mm;
            margin-top: 2mm;
          }
          
          .answer-label {
            font-weight: bold;
            margin-right: 3mm;
            font-size: 14pt;
          }
          
          .answer-box {
            border: 2px solid #000;
            width: 15mm;
            height: 80mm;
            background-color: white;
            display: inline-block;
          }
          
          /* ãƒ•ãƒƒã‚¿ãƒ¼éè¡¨ç¤ºï¼ˆãƒšãƒ¼ã‚¸ç•ªå·ã‚’å‡ºã•ãªã„ï¼‰ */
          footer, .page-info {
            display: none !important;
          }
          
          /* å°åˆ·åˆ¶å¾¡ */
          .no-print {
            display: none !important;
          }
          
          .print-only {
            display: block !important;
          }
          
          /* ãƒšãƒ¼ã‚¸åŒºåˆ‡ã‚Š */
          .page-break {
            page-break-before: always;
            break-before: page;
          }
          
          /* å°åˆ·ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒ†ãƒŠ - æ”¹ãƒšãƒ¼ã‚¸åˆ¶å¾¡ã®ã¿ */
          .print-page {
            /* page-break-inside: avoid ã‚’å‰Šé™¤ */
          }
          
          /* è¤‡æ•°ãƒšãƒ¼ã‚¸å¯¾å¿œ */
          .print-content {
            /* page-break-inside: avoid ã‚’å‰Šé™¤ */
          }
          
          
          /* å°åˆ·æ™‚ã®ä½™ç™½è¨­å®š */
          @page {
            size: A4 landscape;
            margin: 10mm;  /* ä½™ç™½ã‚’é©æ­£åŒ– */
          }

          /* æ¨ªæ›¸ããƒ¢ãƒ¼ãƒ‰ã®ã‚µãƒãƒ¼ãƒˆã¯ä¸è¦ï¼ˆç¸¦æ›¸ãå°‚ç”¨ï¼‰ */
        }
        
        /* ç”»é¢è¡¨ç¤ºç”¨ï¼ˆå°åˆ·æ™‚ã¯éè¡¨ç¤ºï¼‰ */
        @media screen {
          .print-only {
            display: none;
          }
          
          .print-controls {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
          }
          
          .print-controls button {
            margin: 0 5px;
            padding: 8px 16px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
          }
          
          .print-controls button:hover {
            background: #0056b3;
          }
          
          .print-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
          }
        }
    </style>
</head>
<body>
    <!-- å°åˆ·åˆ¶å¾¡ãƒœã‚¿ãƒ³ï¼ˆç”»é¢è¡¨ç¤ºæ™‚ã®ã¿ï¼‰ -->
    <div class="print-controls no-print">
        <button onclick="window.print()">ğŸ–¨ï¸ å°åˆ·</button>
        <button onclick="window.close()">âŒ é–‰ã˜ã‚‹</button>
    </div>
    
    <!-- å°åˆ·ç”¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <div class="sheet" id="printContent">
        <div class="sheet-content">
            {% for question in questions %}
            <div class="question-item">
                <div class="question-number">å•{{ question.question_number | to_kanji_numeral }}</div>
                <div class="question-content">
                    <div class="question-text">{{ question.formatted_text | safe }}</div>
                    <div class="answer-space">
                        <span class="answer-label">ç­”ãˆï¼š</span>
                        <div class="answer-box"></div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    
    <script>
        // å°åˆ·å®Œäº†æ™‚ã®å‡¦ç†
        window.addEventListener('afterprint', function() {
            console.log('å°åˆ·ãŒå®Œäº†ã—ã¾ã—ãŸ');
        });
        
        // å°åˆ·å‰ã®å‡¦ç†
        window.addEventListener('beforeprint', function() {
            console.log('å°åˆ·ã‚’é–‹å§‹ã—ã¾ã™');
        });

        // ç¸¦æ›¸ãã®ã¿å¯¾å¿œï¼ˆæ¨ªæ›¸ãåˆ‡æ›¿ã¯è¡Œã‚ãªã„ï¼‰
    </script>
</body>
</html>