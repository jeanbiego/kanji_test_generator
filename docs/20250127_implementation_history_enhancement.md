# 履歴管理機能の拡張

## 基本情報
- **タスク名**: 履歴管理機能の拡張
- **担当**: AI Assistant
- **開始日**: 2025-01-27
- **完了日**: 未定
- **優先度**: 高
- **影響度**: 高 - データ管理の改善

## 要件定義
### 機能概要
履歴管理機能を拡張し、重複判定を削除し、採点結果を反映して「間違えた回数」、「最後に出題した日」、「正解回数」を記録できるようにする。

### 詳細な要件
1. **重複判定の削除**
   - 履歴管理ページから重複判定機能を削除
   - 重複チェック関連のUI要素を削除
   - 重複チェック関連のロジックを削除

2. **採点結果の反映**
   - 採点結果を履歴に反映
   - 間違えた回数の記録
   - 正解回数の記録
   - 最後に出題した日の記録

3. **履歴データの拡張**
   - 既存の履歴データ構造を拡張
   - 採点統計情報の追加
   - 学習進捗の可視化

### 期待される動作
1. 履歴管理ページで重複判定機能が表示されない
2. 採点結果が履歴に自動反映される
3. 各問題の学習統計が表示される
4. 間違えた回数、正解回数、最後に出題日が記録される

## 設計方針
### アーキテクチャ
- 既存の履歴管理機能の修正
- 採点結果の履歴への反映
- データ構造の拡張

### 実装方法
1. **重複判定の削除**
   - 履歴管理ページのUI修正
   - 重複チェック関連のコード削除
   - 不要な機能の整理

2. **採点結果の反映**
   - 採点結果の履歴への自動反映
   - 統計情報の計算
   - データの永続化

3. **履歴データの拡張**
   - データモデルの拡張
   - 統計情報の表示
   - 学習進捗の可視化

## 実装計画
### Phase 1: 重複判定の削除
- [ ] 履歴管理ページのUI修正
- [ ] 重複チェック関連のコード削除
- [ ] 不要な機能の整理

### Phase 2: 採点結果の反映
- [ ] 採点結果の履歴への自動反映
- [ ] 統計情報の計算
- [ ] データの永続化

### Phase 3: 履歴データの拡張
- [ ] データモデルの拡張
- [ ] 統計情報の表示
- [ ] 学習進捗の可視化

## 技術的詳細
### 修正対象ファイル
- `src/app.py`: 履歴管理ページの修正
- `src/modules/storage.py`: データ構造の拡張
- `src/modules/models.py`: データモデルの拡張

### 使用技術
- Streamlit UI
- CSV入出力
- データ処理
- Python 3.10+

## テスト計画
### 正常系テスト
- 重複判定機能の削除
- 採点結果の履歴反映
- 統計情報の表示

### 異常系テスト
- 採点結果がない場合の処理
- データ整合性の確認
- エラーハンドリング

## リスク評価
### 高リスク
- 既存データの整合性
- データ構造の変更

### 対策
- 段階的な実装
- データバックアップ
- 十分なテスト

## 完了基準
- [ ] 履歴管理ページから重複判定機能が削除される
- [ ] 採点結果が履歴に自動反映される
- [ ] 間違えた回数が記録される
- [ ] 正解回数が記録される
- [ ] 最後に出題した日が記録される
- [ ] 統計情報が適切に表示される

## 注意事項
- 既存の履歴データに影響を与えない
- データ整合性を保つ
- ユーザビリティを向上させる

---

**状態**: 実装準備完了
**最終更新日**: 2025-01-27
