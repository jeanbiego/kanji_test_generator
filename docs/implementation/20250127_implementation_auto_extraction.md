# 問題用紙作成ページの自動抽出機能実装

## 基本情報
- **タスク名**: 問題用紙作成ページの自動抽出機能実装
- **担当**: AI Assistant
- **開始日**: 2025-01-27
- **予定完了日**: 2025-01-28
- **優先度**: 中
- **影響度**: 中 - ユーザビリティの向上

## 要件定義
### 機能概要
問題用紙作成ページの選択方式を簡素化し、自動抽出機能を導入する。

### 詳細な要件
1. **現在の選択方式の廃止**
   - 現在のセッションの問題
   - 保存された問題から選択
   - 特定の問題を選択

2. **自動抽出機能の導入**
   - 苦手漢字抽出：不正解数の多い問題5問を抽出
   - ランダム抽出：ランダムに5問を抽出

3. **UIの簡素化**
   - 複雑な選択UIを削除
   - 2つのボタンによる直感的な操作

## 設計方針
### アーキテクチャ
- 既存の試行データを活用した苦手漢字分析
- ランダム抽出アルゴリズムの実装
- シンプルなUI設計

### 実装方法
1. **苦手漢字抽出ロジック**
   - 試行データから不正解数を集計
   - 問題IDごとの正答率を計算
   - 不正解数の多い問題を上位5問抽出

2. **ランダム抽出ロジック**
   - 保存された問題からランダムに5問選択
   - 重複なしの抽出

3. **UI改善**
   - 選択方式の削除
   - 2つのボタンの配置
   - 抽出結果の表示

## 実装計画
### Phase 1: 要件分析と設計
- [ ] 現在の選択方式の分析
- [ ] 自動抽出機能の設計
- [ ] UI設計の作成

### Phase 2: 苦手漢字抽出機能の実装
- [ ] 試行データの分析ロジック実装
- [ ] 不正解数集計機能の実装
- [ ] 上位5問抽出機能の実装

### Phase 3: ランダム抽出機能の実装
- [ ] ランダム抽出アルゴリズムの実装
- [ ] 重複なし抽出機能の実装
- [ ] 抽出結果の管理

### Phase 4: UI改善
- [ ] 選択方式UIの削除
- [ ] 自動抽出ボタンの配置
- [ ] 抽出結果の表示

### Phase 5: テストと検証
- [ ] 苦手漢字抽出のテスト
- [ ] ランダム抽出のテスト
- [ ] UI操作のテスト

## 技術的詳細
### 修正対象ファイル
- `src/app.py`: 問題用紙作成ページの修正

### 新規実装機能
- 苦手漢字抽出ロジック
- ランダム抽出ロジック
- 抽出結果表示機能

### 使用技術
- Python 3.10+
- Streamlit
- pandas (データ分析)
- 既存の試行データ

## テスト計画
### 正常系テスト
- 苦手漢字抽出の動作
- ランダム抽出の動作
- 抽出結果の表示

### 異常系テスト
- 試行データがない場合の処理
- 問題データがない場合の処理
- 抽出結果が5問未満の場合の処理

### ユーザビリティテスト
- UI操作の直感性
- 抽出結果の分かりやすさ

## リスク評価
### 中リスク
- 既存機能への影響
- 試行データの整合性
- UI変更による混乱

### 対策
- 段階的な実装
- 十分なテスト
- 既存機能の動作確認

## 完了基準
- [ ] 現在の選択方式が削除される
- [ ] 苦手漢字抽出機能が動作する
- [ ] ランダム抽出機能が動作する
- [ ] UIが簡素化される
- [ ] 抽出結果が適切に表示される
- [ ] 既存機能に影響がない

## 注意事項
- 既存の試行データを活用する
- UIの変更は段階的に行う
- 抽出結果の品質を確保する

## 実装完了サマリー

### 実装内容
1. **苦手漢字抽出機能の実装**
   - 試行データから不正解数を集計
   - 問題IDごとの正答率を計算
   - 不正解数の多い問題を上位5問抽出

2. **ランダム抽出機能の実装**
   - 保存された問題からランダムに5問選択
   - 重複なしの抽出アルゴリズム

3. **UI改善**
   - 複雑な選択方式を削除
   - 2つのボタンによる直感的な操作
   - 抽出結果の分かりやすい表示

4. **既存機能との統合**
   - 抽出結果の印刷機能との連携
   - 試行データとの整合性確保

### 動作確認結果
- ✅ 苦手漢字抽出機能が動作する
- ✅ ランダム抽出機能が動作する
- ✅ UIが簡素化される
- ✅ 抽出結果が適切に表示される
- ✅ 既存機能に影響がない

### 実装完了日
**完了日**: 2025-01-27

---

**状態**: 実装完了、テスト完了
**最終更新日**: 2025-01-27
